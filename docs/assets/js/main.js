"use strict";const input=document.querySelector(".js-input"),submitBtn=document.querySelector(".js-submit"),resultList=document.querySelector(".js-results"),favoriteList=document.querySelector(".js-favoriteList");let showList=[],favoritesShows=[];function searchShow(){fetch(`http://api.tvmaze.com/search/shows?q=${input.value}`).then(t=>t.json()).then(t=>{showList=t,paintSearchResult(),listenShowList(),paintFavorite()}).catch(function(t){console.log("Error al traer los datos del servidor",t)})}function setLocalStorage(){localStorage.setItem("favorite",JSON.stringify(favoritesShows))}function getLocalStorage(){const t=JSON.parse(localStorage.getItem("favorite"));null!==t?(favoritesShows=t,paintFavorite()):searchShow()}function paintSearchResult(){let t="";for(let e=0;e<showList.length;e++){t+=!0===(-1!==favoritesShows.findIndex(function(t,s){return t.id===showList[e].show.id}))?`<li class="js-showItem show__item--favorite" id=${showList[e].show.id} data-url="${showList[e].show.image.medium||showList[e].show.image.original}" data-name="${showList[e].show.name}">`:`<li class="js-showItem" id=${showList[e].show.id}>`,t+=`<h3>${showList[e].show.name}</h3>`,t+="<div>",!0==!!showList[e].show.image?t+=`<img src="${showList[e].show.image.medium||showList[e].show.image.original}" alt="imagen de ${showList[e].show.name}">`:t+='<img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="imagen por defecto">',t+="</div>",t+="</li>",resultList.innerHTML=t}listenShowList()}function paintFavorite(){let t="";for(let e=0;e<favoritesShows.length;e++)t+="<li>",t+=`<h3>${favoritesShows[e].name}</h3>`,t+=`<div><img src="${favoritesShows[e].image.medium}" alt=""></div>`,t+="</li>";favoriteList.innerHTML=t}function toggleFavorites(t){const e=parseInt(t.currentTarget.id),s=favoritesShows.findIndex(function(t,s){return t.id===e});if(!0===(-1!==s))favoritesShows.splice(s,1);else for(let t=0;t<showList.length;t++)showList[t].show.id===e&&favoritesShows.push(showList[t].show);setLocalStorage(),paintFavorite(),listenShowList(),paintSearchResult()}function listenShowList(){const t=document.querySelectorAll(".js-showItem");for(let e=0;e<t.length;e++)t[e].addEventListener("click",toggleFavorites)}function handler(t){t.preventDefault(),searchShow()}submitBtn.addEventListener("click",handler),getLocalStorage();