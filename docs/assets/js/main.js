"use strict";const input=document.querySelector(".js-input"),submitBtn=document.querySelector(".js-submit"),resultList=document.querySelector(".js-results"),favoriteList=document.querySelector(".js-favoriteList"),resetBtn=document.querySelector(".js-reset");let showList=[],favoritesShows=[];function setLocalStorage(){localStorage.setItem("favorite",JSON.stringify(favoritesShows))}function getLocalStorage(){const t=JSON.parse(localStorage.getItem("favorite"));null!==t?(favoritesShows=t,paintFavorite()):searchShow()}function searchShow(){fetch(`http://api.tvmaze.com/search/shows?q=${input.value}`).then(t=>t.json()).then(t=>{showList=t,paintSearchResult(),listenShowList(),paintFavorite()}).catch(function(t){console.log("Error al traer los datos del servidor",t)})}function paintSearchResult(){let t="";for(let e=0;e<showList.length;e++){t+=!0===(-1!==favoritesShows.findIndex(function(t,s){return t.id===showList[e].show.id}))?`<li class="js-showItem show show__item--favorite" id=${showList[e].show.id}>`:`<li class="js-showItem show" id=${showList[e].show.id}>`,t+=`<h3 class="show--title">${showList[e].show.name}</h3>`,t+="<div >",!0==!!showList[e].show.image?t+=`<img class="show--image" src="${showList[e].show.image.medium||showList[e].show.image.original}" alt="imagen de ${showList[e].show.name}">`:t+='<img class="show--image" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="imagen por defecto">',t+="</div>",t+="</li>"}resultList.innerHTML=t,listenShowList(),listenFavList()}function paintFavorite(){let t="";for(let e=0;e<favoritesShows.length;e++)t+=`<li class="favorite js-favoriteInput" id="${favoritesShows[e].id}">`,t+=`<h3 class="favorite--title" >${favoritesShows[e].name}</h3>`,t+="<div>",!0==!!favoritesShows[e].image?t+=`<img class="favorite--image" src="${favoritesShows[e].image.medium||favoritesShows[e].image.original}" alt="imagen de ${favoritesShows[e].name}">`:t+='<img class="favorite--image" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="imagen por defecto">',t+="</div>",t+="</li>";favoriteList.innerHTML=t,listenFavList()}function toggleFavorites(t){const e=parseInt(t.currentTarget.id),s=favoritesShows.findIndex(function(t,s){return t.id===e});if(!0===(-1!==s))favoritesShows.splice(s,1);else for(let t=0;t<showList.length;t++)showList[t].show.id===e&&favoritesShows.push(showList[t].show);setLocalStorage(),listenShowList(),listenFavList(),paintFavorite(),paintSearchResult()}function listenShowList(){const t=document.querySelectorAll(".js-showItem");for(let e=0;e<t.length;e++)t[e].addEventListener("click",toggleFavorites)}function listenFavList(){const t=document.querySelectorAll(".js-favoriteInput");for(let e=0;e<t.length;e++)t[e].addEventListener("click",toggleFavorites)}function reset(){favoritesShows.splice(0,favoritesShows.length),console.log(favoritesShows),paintFavorite(),listenShowList(),paintSearchResult(),setLocalStorage()}function handler(t){t.preventDefault(),searchShow(),paintFavorite()}resetBtn.addEventListener("click",reset),submitBtn.addEventListener("click",handler),getLocalStorage();